<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- shortcuteditor.qdoc -->
  <meta name="description" content="The Shortcut Editor example shows how to create a basic, read-write hierarchical model to use with Qt's standard view and QKeySequenceEdit classes. For a description of Model/View Programming, see the Model/View Programming overview.">
  <title>Shortcut Editor Example | Qt Widgets 6.7.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.7</a></li>
<li><a href="qtwidgets-index.html" translate="no">Qt Widgets</a></li>
<li><a href="examples-widgets.html" translate="no">Qt Widgets Examples</a></li>
<li>Shortcut Editor Example</li>
<li id="buildversion"><a href="qtwidgets-index.html" translate="no">Qt 6.7.0 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#design-and-concepts">Design and Concepts</a></li>
<li class="level1"><a href="#shortcuteditormodelitem-class-definition">ShortcutEditorModelItem Class Definition</a></li>
<li class="level1"><a href="#shortcuteditormodel-class-definition">ShortcutEditorModel Class Definition</a></li>
<li class="level1"><a href="#shortcuteditormodel-class-implementation">ShortcutEditorModel Class Implementation</a></li>
<li class="level1"><a href="#setting-up-the-data-in-the-model">Setting Up the Data in the Model</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Shortcut Editor Example</h1>
<!-- $$$widgets/shortcuteditor-brief -->
<p>The Shortcut Editor example shows how to create a basic, read-write hierarchical model to use with Qt's standard view and <a href="qkeysequenceedit.html" translate="no">QKeySequenceEdit</a> classes. For a description of Model/View Programming, see the <a href="model-view-programming.html" translate="no">Model/View Programming</a> overview.</p>
<!-- @@@widgets/shortcuteditor -->
<!-- $$$widgets/shortcuteditor-description -->
<div class="descr" id="details">
<p class="centerAlign"><img src="images/shortcuteditor-example.png" alt="" /></p><p>Qt's model/view architecture provides a standard way for views to manipulate information in a data source, using an abstract model of the data to simplify and standardize the way it is accessed. The shortcut editor model represents the actions as a tree of items, and allow views to access this data via an <a href="model-view-programming.html#models" translate="no">index-based</a> system. More generally, models can be used to represent data in the form of a tree structure by allowing each item to act as a parent to a table of child items.</p>
<h4 id="design-and-concepts">Design and Concepts</h4>
<p>The data structure that we use to represent the structure of the data takes the form of a tree built from ShortcutEditorModelItem objects. Each ShortcutEditorModelItem represents an item in a tree view, and contains two columns of data.</p>
<div class="table"><table class="generic">
 <tr valign="top" class="odd"><td ><img src="images/treemodel-structure.png" alt="" /></td><td ><b>Shortcut Editor Structure</b><p>The data is stored internally in the model using ShortcutEditorModelItem objects that are linked together in a pointer-based tree structure. Generally, each ShortcutEditorModelItem has a parent item, and can have a number of child items. However, the root item in the tree structure has no parent item and it is never referenced outside the model.</p>
<p>Each ShortcutEditorModelItem contains information about its place in the tree structure; it can return its parent item and its row number. Having this information readily available makes implementing the model easier.</p>
<p>Since each item in a tree view usually contains several columns of data (a name and a shortcut in this example), it is natural to store this information in each item. For simplicity, we will use a list of <a href="../qtcore/qvariant.html" translate="no">QVariant</a> objects to store the data for each column in the item.</p>
</td></tr>
</table></div>
<p>The use of a pointer-based tree structure means that, when passing a model index to a view, we can record the address of the corresponding item in the index (see <a href="../qtcore/qabstractitemmodel.html#createIndex" translate="no">QAbstractItemModel::createIndex</a>()) and retrieve it later with <a href="../qtcore/qmodelindex.html#internalPointer" translate="no">QModelIndex::internalPointer</a>(). This makes writing the model easier and ensures that all model indexes that refer to the same item have the same internal data pointer.</p>
<p>With the appropriate data structure in place, we can create a tree model with a minimal amount of extra code to supply model indexes and data to other components.</p>
<h4 id="shortcuteditormodelitem-class-definition">ShortcutEditorModelItem Class Definition</h4>
<p>The ShortcutEditorModelItem class is defined as follows:</p>
<p>The class is a basic C++ class. It does not inherit from <a href="../qtcore/qobject.html" translate="no">QObject</a> or provide signals and slots. It is used to hold a list of QVariants, containing column data, and information about its position in the tree structure. The functions provide the following features:</p>
<ul>
<li>The <code translate="no">appendChildItem()</code> is used to add data when the model is first constructed and is not used during normal use.</li>
<li>The <code translate="no">child()</code> and <code translate="no">childCount()</code> functions allow the model to obtain information about any child items.</li>
<li>Information about the number of columns associated with the item is provided by <code translate="no">columnCount()</code>, and the data in each column can be obtained with the data() function.</li>
<li>The <code translate="no">row()</code> and <code translate="no">parent()</code> functions are used to obtain the item's row number and parent item.</li>
</ul>
<p>The parent item and column data are stored in the <code translate="no">parentItem</code> and <code translate="no">itemData</code> private member variables. The <code translate="no">childItems</code> variable contains a list of pointers to the item's own child items.</p>
<h4 id="shortcuteditormodel-class-definition">ShortcutEditorModel Class Definition</h4>
<p>The <code translate="no">ShortcutEditorModel</code> class is defined as follows:</p>
<pre class="cpp" translate="no">
 <span class="keyword">class</span> ShortcutEditorModel : <span class="keyword">public</span> <span class="type"><a href="../qtcore/qabstractitemmodel.html" translate="no">QAbstractItemModel</a></span>
 {
     Q_OBJECT

     <span class="keyword">class</span> ShortcutEditorModelItem
     {
     <span class="keyword">public</span>:
         <span class="keyword">explicit</span> ShortcutEditorModelItem(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qlist.html" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span><span class="operator">&gt;</span> <span class="operator">&amp;</span>data<span class="operator">,</span>
                                          ShortcutEditorModelItem <span class="operator">*</span>parentItem <span class="operator">=</span> nullptr);
         <span class="operator">~</span>ShortcutEditorModelItem();

         <span class="type">void</span> appendChild(ShortcutEditorModelItem <span class="operator">*</span>child);

         ShortcutEditorModelItem <span class="operator">*</span>child(<span class="type">int</span> row) <span class="keyword">const</span>;
         <span class="type">int</span> childCount() <span class="keyword">const</span>;
         <span class="type">int</span> columnCount() <span class="keyword">const</span>;
         <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> data(<span class="type">int</span> column) <span class="keyword">const</span>;
         <span class="type">int</span> row() <span class="keyword">const</span>;
         ShortcutEditorModelItem <span class="operator">*</span>parentItem() <span class="keyword">const</span>;
         <span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span>action() <span class="keyword">const</span>;

     <span class="keyword">private</span>:
         <span class="type"><a href="../qtcore/qlist.html" translate="no">QList</a></span><span class="operator">&lt;</span>ShortcutEditorModelItem <span class="operator">*</span><span class="operator">&gt;</span> m_childItems;
         <span class="type"><a href="../qtcore/qlist.html" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span><span class="operator">&gt;</span> m_itemData;
         ShortcutEditorModelItem <span class="operator">*</span>m_parentItem;
     };

 <span class="keyword">public</span>:
     <span class="keyword">explicit</span> ShortcutEditorModel(<span class="type"><a href="../qtcore/qobject.html" translate="no">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
     <span class="operator">~</span>ShortcutEditorModel() override;

     <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> data(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role <span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) <span class="keyword">const</span> override;
     <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>ItemFlags flags(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span> override;
     <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> headerData(<span class="type">int</span> section<span class="operator">,</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>Orientation orientation<span class="operator">,</span> <span class="type">int</span> role <span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) <span class="keyword">const</span> override;
     <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> index(<span class="type">int</span> row<span class="operator">,</span> <span class="type">int</span> column<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent <span class="operator">=</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>()) <span class="keyword">const</span> override;
     <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> parent(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span> override;
     <span class="type">int</span> rowCount(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index <span class="operator">=</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>()) <span class="keyword">const</span> override;
     <span class="type">int</span> columnCount(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index <span class="operator">=</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>()) <span class="keyword">const</span> override;

     <span class="type">bool</span> setData(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> <span class="operator">&amp;</span>value<span class="operator">,</span> <span class="type">int</span> role <span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>EditRole) override;

     <span class="type">void</span> setActions();

 <span class="keyword">private</span>:
     <span class="type">void</span> setupModelData(ShortcutEditorModelItem <span class="operator">*</span>parent);

     ShortcutEditorModelItem <span class="operator">*</span>m_rootItem;
 };
</pre>
<p>This class is similar to most other subclasses of <a href="../qtcore/qabstractitemmodel.html" translate="no">QAbstractItemModel</a> that provide read-write models. Only the form of the constructor and the <code translate="no">setupModelData()</code> function are specific to this model. In addition, we provide a destructor to clean up when the model is destroyed.</p>
<h4 id="shortcuteditormodel-class-implementation">ShortcutEditorModel Class Implementation</h4>
<p>The constructor takes an argument containing the data that the model will share with views and delegates:</p>
<pre class="cpp" translate="no">
 ShortcutEditorModel<span class="operator">::</span>ShortcutEditorModel(<span class="type"><a href="../qtcore/qobject.html" translate="no">QObject</a></span> <span class="operator">*</span>parent)
     : <span class="type"><a href="../qtcore/qabstractitemmodel.html" translate="no">QAbstractItemModel</a></span>(parent)
 {
     m_rootItem <span class="operator">=</span> <span class="keyword">new</span> ShortcutEditorModelItem({tr(<span class="string">&quot;Name&quot;</span>)<span class="operator">,</span> tr(<span class="string">&quot;Shortcut&quot;</span>)});
 }
</pre>
<p>It is up to the constructor to create a root item for the model. This item only contains vertical header data for convenience. We also use it to reference the internal data structure that contains the model data, and it is used to represent an imaginary parent of top-level items in the model.</p>
<p>The model's internal data structure is populated with items by the <code translate="no">setupModelData()</code> function. We will examine this function separately at the end of this document.</p>
<p>The destructor ensures that the root item and all of its descendants are deleted when the model is destroyed:</p>
<pre class="cpp" translate="no">
 ShortcutEditorModel<span class="operator">::</span><span class="operator">~</span>ShortcutEditorModel()
 {
     <span class="keyword">delete</span> m_rootItem;
 }
</pre>
<p>Since we cannot add data to the model after it is constructed and set up, this simplifies the way that the internal tree of items is managed.</p>
<p>Models must implement an <code translate="no">index()</code> function to provide indexes for views and delegates to use when accessing data. Indexes are created for other components when they are referenced by their row and column numbers, and their parent model index. If an invalid model index is specified as the parent, it is up to the model to return an index that corresponds to a top-level item in the model.</p>
<p>When supplied with a model index, we first check whether it is valid. If it is not, we assume that a top-level item is being referred to; otherwise, we obtain the data pointer from the model index with its <a href="../qtcore/qmodelindex.html#internalPointer" translate="no">internalPointer</a>() function and use it to reference a <code translate="no">TreeItem</code> object. Note that all the model indexes that we construct will contain a pointer to an existing <code translate="no">TreeItem</code>, so we can guarantee that any valid model indexes that we receive will contain a valid data pointer.</p>
<pre class="cpp" translate="no">
 <span class="type">void</span> ShortcutEditorModel<span class="operator">::</span>setActions()
 {
     beginResetModel();
     setupModelData(m_rootItem);
     endResetModel();
 }
</pre>
<p>Since the row and column arguments to this function refer to a child item of the corresponding parent item, we obtain the item using the <code translate="no">TreeItem::child()</code> function. The <a href="../qtcore/qabstractitemmodel.html#createIndex" translate="no">createIndex</a>() function is used to create a model index to be returned. We specify the row and column numbers, and a pointer to the item itself. The model index can be used later to obtain the item's data.</p>
<p>The way that the <code translate="no">TreeItem</code> objects are defined makes writing the <code translate="no">parent()</code> function easy:</p>
<pre class="cpp" translate="no">
 <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> ShortcutEditorModel<span class="operator">::</span>index(<span class="type">int</span> row<span class="operator">,</span> <span class="type">int</span> column<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (<span class="operator">!</span>hasIndex(row<span class="operator">,</span> column<span class="operator">,</span> parent))
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>();

     ShortcutEditorModelItem <span class="operator">*</span>parentItem;
     <span class="keyword">if</span> (<span class="operator">!</span>parent<span class="operator">.</span>isValid())
         parentItem <span class="operator">=</span> m_rootItem;
     <span class="keyword">else</span>
         parentItem <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem<span class="operator">*</span><span class="operator">&gt;</span>(parent<span class="operator">.</span>internalPointer());

     ShortcutEditorModelItem <span class="operator">*</span>childItem <span class="operator">=</span> parentItem<span class="operator">-</span><span class="operator">&gt;</span>child(row);
     <span class="keyword">if</span> (childItem)
         <span class="keyword">return</span> createIndex(row<span class="operator">,</span> column<span class="operator">,</span> childItem);

     <span class="keyword">return</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>();
 }
</pre>
<p>We only need to ensure that we never return a model index corresponding to the root item. To be consistent with the way that the <code translate="no">index()</code> function is implemented, we return an invalid model index for the parent of any top-level items in the model.</p>
<p>When creating a model index to return, we must specify the row and column numbers of the parent item within its own parent. We can easily discover the row number with the <code translate="no">TreeItem::row()</code> function, but we follow a convention of specifying 0 as the column number of the parent. The model index is created with <a href="../qtcore/qabstractitemmodel.html#createIndex" translate="no">createIndex</a>() in the same way as in the <code translate="no">index()</code> function.</p>
<p>The <code translate="no">rowCount()</code> function simply returns the number of child items for the <code translate="no">TreeItem</code> that corresponds to a given model index, or the number of top-level items if an invalid index is specified:</p>
<pre class="cpp" translate="no">
 <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> ShortcutEditorModel<span class="operator">::</span>parent(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>();

     ShortcutEditorModelItem <span class="operator">*</span>childItem <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem<span class="operator">*</span><span class="operator">&gt;</span>(index<span class="operator">.</span>internalPointer());
     ShortcutEditorModelItem <span class="operator">*</span>parentItem <span class="operator">=</span> childItem<span class="operator">-</span><span class="operator">&gt;</span>parentItem();

     <span class="keyword">if</span> (parentItem <span class="operator">=</span><span class="operator">=</span> m_rootItem)
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span>();

     <span class="keyword">return</span> createIndex(parentItem<span class="operator">-</span><span class="operator">&gt;</span>row()<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> parentItem);
 }
</pre>
<p>Since each item manages its own column data, the <code translate="no">columnCount()</code> function has to call the item's own <code translate="no">columnCount()</code> function to determine how many columns are present for a given model index. As with the <code translate="no">rowCount()</code> function, if an invalid model index is specified, the number of columns returned is determined from the root item:</p>
<pre class="cpp" translate="no">
 <span class="type">int</span> ShortcutEditorModel<span class="operator">::</span>rowCount(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
 {
     ShortcutEditorModelItem <span class="operator">*</span>parentItem;
     <span class="keyword">if</span> (parent<span class="operator">.</span>column() <span class="operator">&gt;</span> <span class="number">0</span>)
         <span class="keyword">return</span> <span class="number">0</span>;

     <span class="keyword">if</span> (<span class="operator">!</span>parent<span class="operator">.</span>isValid())
         parentItem <span class="operator">=</span> m_rootItem;
     <span class="keyword">else</span>
         parentItem <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem<span class="operator">*</span><span class="operator">&gt;</span>(parent<span class="operator">.</span>internalPointer());

     <span class="keyword">return</span> parentItem<span class="operator">-</span><span class="operator">&gt;</span>childCount();
 }
</pre>
<p>Data is obtained from the model via <code translate="no">data()</code>. Since the item manages its own columns, we need to use the column number to retrieve the data with the <code translate="no">TreeItem::data()</code> function:</p>
<pre class="cpp" translate="no">
 <span class="type">int</span> ShortcutEditorModel<span class="operator">::</span>columnCount(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (parent<span class="operator">.</span>isValid())
         <span class="keyword">return</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem<span class="operator">*</span><span class="operator">&gt;</span>(parent<span class="operator">.</span>internalPointer())<span class="operator">-</span><span class="operator">&gt;</span>columnCount();

     <span class="keyword">return</span> m_rootItem<span class="operator">-</span><span class="operator">&gt;</span>columnCount();
 }
</pre>
<p>Note that we only support the <a href="../qtcore/qt.html#ItemDataRole-enum" translate="no">DisplayRole</a> in this implementation, and we also return invalid <a href="../qtcore/qvariant.html" translate="no">QVariant</a> objects for invalid model indexes.</p>
<p>We use the <code translate="no">flags()</code> function to ensure that views know that the model is read-only:</p>
<pre class="cpp" translate="no">
 <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> ShortcutEditorModel<span class="operator">::</span>data(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span>();

     <span class="keyword">if</span> (role <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole <span class="operator">&amp;</span><span class="operator">&amp;</span> role <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>EditRole)
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span>();

     ShortcutEditorModelItem <span class="operator">*</span>item <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem<span class="operator">*</span><span class="operator">&gt;</span>(index<span class="operator">.</span>internalPointer());
     <span class="keyword">return</span> item<span class="operator">-</span><span class="operator">&gt;</span>data(index<span class="operator">.</span>column());
 }
</pre>
<p>The <code translate="no">headerData()</code> function returns data that we conveniently stored in the root item:</p>
<pre class="cpp" translate="no">
 <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>ItemFlags ShortcutEditorModel<span class="operator">::</span>flags(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
         <span class="keyword">return</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>NoItemFlags;

     <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>ItemFlags modelFlags <span class="operator">=</span> <span class="type"><a href="../qtcore/qabstractitemmodel.html" translate="no">QAbstractItemModel</a></span><span class="operator">::</span>flags(index);
     <span class="keyword">if</span> (index<span class="operator">.</span>column() <span class="operator">=</span><span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type">int</span><span class="operator">&gt;</span>(Column<span class="operator">::</span>Shortcut))
         modelFlags <span class="operator">|</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>ItemIsEditable;

     <span class="keyword">return</span> modelFlags;
 }
</pre>
<p>This information could have been supplied in a different way: either specified in the constructor, or hard coded into the <code translate="no">headerData()</code> function.</p>
<pre class="cpp" translate="no">
 <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> ShortcutEditorModel<span class="operator">::</span>headerData(<span class="type">int</span> section<span class="operator">,</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>Orientation orientation<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span>
 {
     <span class="keyword">if</span> (orientation <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>Horizontal <span class="operator">&amp;</span><span class="operator">&amp;</span> role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) {
         <span class="keyword">return</span> m_rootItem<span class="operator">-</span><span class="operator">&gt;</span>data(section);
     }

     <span class="keyword">return</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span>();
 }
</pre>
<p>TODO</p>
<pre class="cpp" translate="no">
 <span class="type">void</span> ShortcutEditorModel<span class="operator">::</span>setupModelData(ShortcutEditorModelItem <span class="operator">*</span>parent)
 {
     ActionsMap actionsMap;
     Application <span class="operator">*</span>application <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>Application <span class="operator">*</span><span class="operator">&gt;</span>(<span class="type"><a href="../qtcore/qcoreapplication.html" translate="no">QCoreApplication</a></span><span class="operator">::</span>instance());
     ActionManager <span class="operator">*</span>actionManager <span class="operator">=</span> application<span class="operator">-</span><span class="operator">&gt;</span>actionManager();
     <span class="keyword">const</span> <span class="type"><a href="../qtcore/qlist.html" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span><span class="operator">&gt;</span> registeredActions <span class="operator">=</span> actionManager<span class="operator">-</span><span class="operator">&gt;</span>registeredActions();
     <span class="keyword">for</span> (<span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span>action : registeredActions) {
         <span class="type"><a href="../qtcore/qstring.html" translate="no">QString</a></span> context <span class="operator">=</span> actionManager<span class="operator">-</span><span class="operator">&gt;</span>contextForAction(action);
         <span class="type"><a href="../qtcore/qstring.html" translate="no">QString</a></span> category <span class="operator">=</span> actionManager<span class="operator">-</span><span class="operator">&gt;</span>categoryForAction(action);
         actionsMap<span class="operator">[</span>context<span class="operator">]</span><span class="operator">[</span>category<span class="operator">]</span><span class="operator">.</span>append(action);
     }

     <span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span>nullAction <span class="operator">=</span> nullptr;
     <span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html" translate="no">QString</a></span> contextIdPrefix <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;
     <span class="comment">// Go through each context, one context - many categories each iteration</span>
     <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>contextLevel : actionsMap<span class="operator">.</span>keys()) {
         ShortcutEditorModelItem <span class="operator">*</span>contextLevelItem <span class="operator">=</span> <span class="keyword">new</span> ShortcutEditorModelItem({contextLevel<span class="operator">,</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span><span class="operator">::</span>fromValue(nullAction)}<span class="operator">,</span> parent);
         parent<span class="operator">-</span><span class="operator">&gt;</span>appendChild(contextLevelItem);

         <span class="comment">// Go through each category, one category - many actions each iteration</span>
         <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>categoryLevel : actionsMap<span class="operator">[</span>contextLevel<span class="operator">]</span><span class="operator">.</span>keys()) {
             ShortcutEditorModelItem <span class="operator">*</span>categoryLevelItem <span class="operator">=</span> <span class="keyword">new</span> ShortcutEditorModelItem({categoryLevel<span class="operator">,</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span><span class="operator">::</span>fromValue(nullAction)}<span class="operator">,</span> contextLevelItem);
             contextLevelItem<span class="operator">-</span><span class="operator">&gt;</span>appendChild(categoryLevelItem);
             <span class="keyword">for</span> (<span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span>action : actionsMap<span class="operator">[</span>contextLevel<span class="operator">]</span><span class="operator">[</span>categoryLevel<span class="operator">]</span>) {
                 <span class="type"><a href="../qtcore/qstring.html" translate="no">QString</a></span> name <span class="operator">=</span> action<span class="operator">-</span><span class="operator">&gt;</span>text();
                 <span class="keyword">if</span> (name<span class="operator">.</span>isEmpty() <span class="operator">|</span><span class="operator">|</span> <span class="operator">!</span>action)
                     <span class="keyword">continue</span>;

                 ShortcutEditorModelItem <span class="operator">*</span>actionLevelItem <span class="operator">=</span> <span class="keyword">new</span> ShortcutEditorModelItem({name<span class="operator">,</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span><span class="operator">::</span>fromValue(<span class="keyword">reinterpret_cast</span><span class="operator">&lt;</span><span class="type">void</span> <span class="operator">*</span><span class="operator">&gt;</span>(action))}<span class="operator">,</span> categoryLevelItem);
                 categoryLevelItem<span class="operator">-</span><span class="operator">&gt;</span>appendChild(actionLevelItem);
             }
         }
     }
 }
</pre>
<p>TODO</p>
<pre class="cpp" translate="no">
 <span class="type">bool</span> ShortcutEditorModel<span class="operator">::</span>setData(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qmodelindex.html" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="../qtcore/qvariant.html" translate="no">QVariant</a></span> <span class="operator">&amp;</span>value<span class="operator">,</span> <span class="type">int</span> role)
 {
     <span class="keyword">if</span> (role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtcore/qt.html" translate="no">Qt</a></span><span class="operator">::</span>EditRole <span class="operator">&amp;</span><span class="operator">&amp;</span> index<span class="operator">.</span>column() <span class="operator">=</span><span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type">int</span><span class="operator">&gt;</span>(Column<span class="operator">::</span>Shortcut)) {
         <span class="type"><a href="../qtcore/qstring.html" translate="no">QString</a></span> keySequenceString <span class="operator">=</span> value<span class="operator">.</span>toString();
         ShortcutEditorModelItem <span class="operator">*</span>item <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span>ShortcutEditorModelItem <span class="operator">*</span><span class="operator">&gt;</span>(index<span class="operator">.</span>internalPointer());
         <span class="type"><a href="../qtgui/qaction.html" translate="no">QAction</a></span> <span class="operator">*</span>itemAction <span class="operator">=</span> item<span class="operator">-</span><span class="operator">&gt;</span>action();
         <span class="keyword">if</span> (itemAction) {
             <span class="keyword">if</span> (keySequenceString <span class="operator">=</span><span class="operator">=</span> itemAction<span class="operator">-</span><span class="operator">&gt;</span>shortcut()<span class="operator">.</span>toString(<span class="type"><a href="../qtgui/qkeysequence.html" translate="no">QKeySequence</a></span><span class="operator">::</span>NativeText))
                 <span class="keyword">return</span> <span class="keyword">true</span>;
             itemAction<span class="operator">-</span><span class="operator">&gt;</span>setShortcut(keySequenceString);
         }
         Q_EMIT dataChanged(index<span class="operator">,</span> index);

         <span class="keyword">if</span> (keySequenceString<span class="operator">.</span>isEmpty())
             <span class="keyword">return</span> <span class="keyword">true</span>;
     }

     <span class="keyword">return</span> <span class="type"><a href="../qtcore/qabstractitemmodel.html" translate="no">QAbstractItemModel</a></span><span class="operator">::</span>setData(index<span class="operator">,</span> value<span class="operator">,</span> role);
 }
</pre>
<p>TODO</p>
<h4 id="setting-up-the-data-in-the-model">Setting Up the Data in the Model</h4>
<p>We use the <code translate="no">setupModelData()</code> function to set up the initial data in the model. This function retrieves the registered actions text and creates item objects that record both the data and the overall model structure. Naturally, this function works in a way that is very specific to this model. We provide the following description of its behavior, and refer the reader to the example code itself for more information.</p>
<p>To ensure that the model works correctly, it is only necessary to create instances of ShortcutEditorModelItem with the correct data and parent item.</p>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/widgets/shortcuteditor?h=6.7" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@widgets/shortcuteditor -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
