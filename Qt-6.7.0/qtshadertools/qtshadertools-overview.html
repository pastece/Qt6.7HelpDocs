<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qtshadertools-overview.qdoc -->
  <meta name="description" content="Provides insight into the Qt Shader Tools module.">
  <title>Qt Shader Tools Overview | Shader Tools 6.7.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.7</a></li>
<li><a href="qtshadertools-index.html" translate="no">Shader Tools</a></li>
<li>Qt Shader Tools Overview</li>
<li id="buildversion"><a href="qtshadertools-index.html" translate="no">Qt 6.7.0 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#typical-usage-with-qt-quick">Typical Usage with Qt Quick</a></li>
<li class="level1"><a href="#typical-usage-with-qt-quick-3d">Typical Usage with Qt Quick 3D</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt Shader Tools Overview</h1>
<!-- $$$qtshadertools-overview.html-description -->
<div class="descr" id="details">
<p>The Qt Shader Tools module builds on the SPIR-V Open Source Ecosystem as described at <a href="https://www.khronos.org/spir/" translate="no">the Khronos SPIR-V web site</a>. For compiling into SPIR-V, <a href="https://github.com/KhronosGroup/glslang" translate="no">glslang</a> is used, while translating and reflecting is done via <a href="https://github.com/KhronosGroup/SPIRV-Cross" translate="no">SPIRV-Cross</a>.</p>
<p>For shader code to be written once in Qt applications and libraries, all shaders are expected to be written in a single language, which is then compiled into SPIR-V. This shading language is Vulkan-compatible GLSL at the moment. This is different from what the OpenGL-style GLSL Qt 5.x expects. See the <a href="https://github.com/KhronosGroup/GLSL/blob/master/extensions/khr/GL_KHR_vulkan_glsl.txt" translate="no">GL_KHR_vulkan_glslspecification</a> for an overview of the differences.</p>
<p>Source code for other shading languages, such as GLSL, HLSL, and the Metal Shading Language, is then generated from translating the SPIR-V bytecode, together with reflection information (inputs, outputs, shader resources). For GLSL in particular, this also involves generating multiple variants, meaning source code suitable for different GLSL versions, such as GLSL ES 100, GLSL ES 300, and GLSL 120 and 150. This is then packed into serializable <a href="../qtgui/qshader.html" translate="no">QShader</a> container objects, typically stored on disk as <code translate="no">.qsb</code> files. The Qt Rendering Hardware Interface consumes <a href="../qtgui/qshader.html" translate="no">QShader</a> instances directly, picking the shader source or bytecode that is best suited for the graphics API used at run time. A <a href="../qtgui/qshader.html" translate="no">QShader</a> object is typically deserialized from <code translate="no">.qsb</code> files shipped with the application or Qt itself in the Qt Resource System.</p>
<p>Some platforms provide the option of compiling shader source code to an intermediate format similar to SPIR-V. This involves running platform-specific tools. With Direct 3D, the <code translate="no">qsb</code> tool provides the option to invoke <a href="https://docs.microsoft.com/en-us/windows/win32/direct3dtools/fxc" translate="no">the fxc tool from the Windows SDK</a> once the HLSL source code has been generated. It then replaces the HLSL source code with the <code translate="no">DXBC</code> binary generated by <code translate="no">fxc</code>. This can have a positive effect on applications' runtime performance since they no longer need to do the first phase of compilation (HLSL source to DXBC) themselves. For macOS and iOS, the <a href="https://developer.apple.com/documentation/metal/libraries/building_a_library_with_metal_s_command-line_tools?language=objc" translate="no">XCode SDK provides similar tools</a>. The downside of this approach is that running these tools is only possible on their respective platforms. Therefore, this is best suited for use in combination with qsb's CMake integration since doing shader conditioning at application build time implicitly comes with the knowledge needed about the target platform and what platform-specific tools can be invoked.</p>
<p>The following diagram describes the steps that happen during an invocation of the <code translate="no">qsb</code> tool:</p>
<p class="centerAlign"><img src="images/shaderconditioning.png" alt="" /></p><p>The main components of the Qt shader conditioning system are:</p>
<ul>
<li>the <code translate="no">qsb</code> command-line tool</li>
<li>CMake integration for the <code translate="no">qsb</code> tool</li>
<li><a href="../qtgui/qshader.html" translate="no">QShader</a> (part of the <a href="../qtgui/qtgui-module.html" translate="no">QtGui</a> module)</li>
<li><a href="qshaderbaker.html" translate="no">QShaderBaker</a> (part of this module, the library equivalent of the <code translate="no">qsb</code> tool)</li>
</ul>
<h2 id="typical-usage-with-qt-quick">Typical Usage with Qt Quick</h2>
<p>Application developers typically work with custom shader code in Qt Quick scenes that have one of the following:</p>
<ul>
<li><a href="../qtquick/qml-qtquick-shadereffect.html" translate="no">ShaderEffect</a> items</li>
<li><a href="../qtquick/qquickitem.html" translate="no">QQuickItem</a> subclasses that use scene graph nodes in combination with custom materials built by subclassing <a href="../qtquick/qsgmaterial.html" translate="no">QSGMaterial</a>.</li>
</ul>
<p>For example, consider the following QML snippet:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="../qtquick/qml-qtquick-shadereffect.html" translate="no">ShaderEffect</a></span> {
     <span class="name">width</span>: <span class="number">100</span>; <span class="name">height</span>: <span class="number">100</span>
     <span class="name">fragmentShader</span>: <span class="string">&quot;myeffect.frag.qsb&quot;</span>
 }
</pre>
<p>Here the <a href="../qtquick/qml-qtquick-shadereffect.html#fragmentShader-prop" translate="no">fragmentShader</a> URL refers to a <code translate="no">.qsb</code> file relative to the <code translate="no">.qml</code> file's location. The application is expected to ship <code translate="no">myeffect.frag.qsb</code> next to the <code translate="no">.qml</code> file. To generate that file from the Vulkan-style GLSL source (which itself does not need to be shipped with the application), the application must use the <code translate="no">qsb</code> tool either directly or via CMake.</p>
<h2 id="typical-usage-with-qt-quick-3d">Typical Usage with Qt Quick 3D</h2>
<p>Qt Quick 3D uses the Shader Tools module directly to perform shader conditioning at run time. In addition, it provides solutions for pre-generating shaders for materials at build time, in case a runtime dependency to shader compilers and other tools is not seen ideal. In either case, developers don't need to work directly with the <code translate="no">qsb</code> tool since it's encapsulated by the Qt Quick 3D's own framework and tools.</p>
</div>
<!-- @@@qtshadertools-overview.html -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
