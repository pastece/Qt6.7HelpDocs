<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qcache.qdoc -->
  <meta name="description" content="The QCache class is a template class that provides a cache.">
  <title>QCache Class | Qt Core 6.7.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html" translate="no">Qt 6.7</a></li>
<li><a href="qtcore-index.html" translate="no">Qt Core</a></li>
<li><a href="qtcore-module.html" translate="no">C++ Classes</a></li>
<li>QCache</li>
<li id="buildversion"><a href="qtcore-index.html" translate="no">Qt 6.7.0 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#public-functions">Public Functions</a></li>
<li class="level1"><a href="#details">Detailed Description</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title" translate="no">QCache Class</h1>
<span class="small-subtitle" translate="no">template &lt;typename Key, typename T&gt; class QCache</span>
<!-- $$$QCache-brief -->
<p>The QCache class is a template class that provides a cache. <a href="#details">More...</a></p>
<!-- @@@QCache -->
<div class="table"><table class="alignedsummary" translate="no">
<tr><td class="memItemLeft rightAlign topAlign"> Header:</td><td class="memItemRight bottomAlign">  <span class="preprocessor">#include &lt;QCache&gt;</span></td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> CMake:</td><td class="memItemRight bottomAlign"> find_package(Qt6 REQUIRED COMPONENTS Core) <br/>
target_link_libraries(mytarget PRIVATE Qt6::Core)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> qmake:</td><td class="memItemRight bottomAlign"> QT += core</td></tr>
</table></div>
<ul>
<li><a href="qcache-members.html">List of all members, including inherited members</a></li>
<li>QCache is part of <a href="shared.html">Implicitly Shared Classes</a>.</li>
</ul>
<p><b>Note:</b> All functions in this class are <a href="../qtdoc/threads-reentrancy.html" translate="no">reentrant</a>.</p>
<h2 id="public-functions">Public Functions</h2>
<div class="table"><table class="alignedsummary" translate="no">
<tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#QCache-1" translate="no">QCache</a></b>(qsizetype <i>maxCost</i> = 100)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#dtor.QCache" translate="no">~QCache</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#clear" translate="no">clear</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#contains" translate="no">contains</a></b>(const Key &amp;<i>key</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> qsizetype </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#count" translate="no">count</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#insert" translate="no">insert</a></b>(const Key &amp;<i>key</i>, T *<i>object</i>, qsizetype <i>cost</i> = 1)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#isEmpty" translate="no">isEmpty</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QList&lt;Key&gt; </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#keys" translate="no">keys</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> qsizetype </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#maxCost" translate="no">maxCost</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> T *</td><td class="memItemRight bottomAlign"><b><a href="qcache.html#object" translate="no">object</a></b>(const Key &amp;<i>key</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#remove" translate="no">remove</a></b>(const Key &amp;<i>key</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#setMaxCost" translate="no">setMaxCost</a></b>(qsizetype <i>cost</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> qsizetype </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#size" translate="no">size</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> T *</td><td class="memItemRight bottomAlign"><b><a href="qcache.html#take" translate="no">take</a></b>(const Key &amp;<i>key</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> qsizetype </td><td class="memItemRight bottomAlign"><b><a href="qcache.html#totalCost" translate="no">totalCost</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> T *</td><td class="memItemRight bottomAlign"><b><a href="qcache.html#operator-5b-5d" translate="no">operator[]</a></b>(const Key &amp;<i>key</i>) const</td></tr>
</table></div>
<!-- $$$QCache-description -->
<div class="descr">
<h2 id="details">Detailed Description</h2>
<p>QCache&lt;Key, T&gt; defines a cache that stores objects of type T associated with keys of type Key. For example, here's the definition of a cache that stores objects of type Employee associated with an integer key:</p>
<pre class="cpp" translate="no">
 <span class="type">QCache</span><span class="operator">&lt;</span><span class="type">int</span><span class="operator">,</span> Employee<span class="operator">&gt;</span> cache;
</pre>
<p>Here's how to insert an object in the cache:</p>
<pre class="cpp" translate="no">
 Employee <span class="operator">*</span>employee <span class="operator">=</span> <span class="keyword">new</span> Employee;
 employee<span class="operator">-</span><span class="operator">&gt;</span>setId(<span class="number">37</span>);
 employee<span class="operator">-</span><span class="operator">&gt;</span>setName(<span class="string">&quot;Richard Schmit&quot;</span>);
 <span class="operator">.</span><span class="operator">.</span><span class="operator">.</span>
 cache<span class="operator">.</span>insert(employee<span class="operator">-</span><span class="operator">&gt;</span>id()<span class="operator">,</span> employee);
</pre>
<p>The advantage of using QCache over some other key-based data structure (such as <a href="qmap.html" translate="no">QMap</a> or <a href="qhash.html#qhash" translate="no">QHash</a>) is that QCache automatically takes ownership of the objects that are inserted into the cache and deletes them to make room for new objects, if necessary. When inserting an object into the cache, you can specify a <i>cost</i>, which should bear some approximate relationship to the amount of memory taken by the object. When the sum of all objects' costs (<a href="qcache.html#totalCost" translate="no">totalCost</a>()) exceeds the cache's limit (<a href="qcache.html#maxCost" translate="no">maxCost</a>()), QCache starts deleting objects in the cache to keep under the limit, starting with less recently accessed objects.</p>
<p>By default, QCache's <a href="qcache.html#maxCost" translate="no">maxCost</a>() is 100. You can specify a different value in the QCache constructor:</p>
<pre class="cpp" translate="no">
 <span class="type">QCache</span><span class="operator">&lt;</span><span class="type">int</span><span class="operator">,</span> MyDataStructure<span class="operator">&gt;</span> cache(<span class="number">5000</span>);
</pre>
<p>Each time you call <a href="qcache.html#insert" translate="no">insert</a>(), you can specify a cost as third argument (after the key and a pointer to the object to insert). After the call, the inserted object is owned by the QCache, which may delete it at any time to make room for other objects.</p>
<p>To look up objects in the cache, use <a href="qcache.html#object" translate="no">object</a>() or operator[](). This function looks up an object by its key, and returns either a pointer to the cached object (which is owned by the cache) or <code translate="no">nullptr</code>.</p>
<p>If you want to remove an object from the cache for a particular key, call <a href="qcache.html#remove" translate="no">remove</a>(). This will also delete the object. If you want to remove an object from the cache without the QCache deleting it, use <a href="qcache.html#take" translate="no">take</a>().</p>
</div>
<p><b>See also </b><a href="../qtgui/qpixmapcache.html" translate="no">QPixmapCache</a>, <a href="qhash.html#qhash" translate="no">QHash</a>, and <a href="qmap.html" translate="no">QMap</a>.</p>
<!-- @@@QCache -->
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$QCache$$$QCacheqsizetype -->
<h3 class="fn" translate="no" id="QCache-1"><code class="details extra" translate="no">[explicit noexcept]</code> QCache::<span class="name">QCache</span>(<span class="type">qsizetype</span> <i>maxCost</i> = 100)</h3>
<p>Constructs a cache whose contents will never have a total cost greater than <i translate="no">maxCost</i>.</p>
<!-- @@@QCache -->
<!-- $$$~QCache[overload1]$$$~QCache -->
<h3 class="fn" translate="no" id="dtor.QCache">QCache::<span class="name">~QCache</span>()</h3>
<p>Destroys the cache. Deletes all the objects in the cache.</p>
<!-- @@@~QCache -->
<!-- $$$clear[overload1]$$$clear -->
<h3 class="fn" translate="no" id="clear"><code class="details extra" translate="no">[noexcept(...)]</code> <span class="type">void</span> QCache::<span class="name">clear</span>()</h3>
<p>Deletes all the objects in the cache.</p>
<div class="admonition note">
<p><b>Note: </b>This function does not throw any exception when &quot;std::is_nothrow_destructible_v&lt;Node&gt;&quot; is true.</p>
</div>
<p><b>See also </b><a href="qcache.html#remove" translate="no">remove</a>() and <a href="qcache.html#take" translate="no">take</a>().</p>
<!-- @@@clear -->
<!-- $$$contains[overload1]$$$containsconstKey& -->
<h3 class="fn" translate="no" id="contains"><code class="details extra" translate="no">[noexcept]</code> <span class="type">bool</span> QCache::<span class="name">contains</span>(const <span class="type">Key</span> &amp;<i>key</i>) const</h3>
<p>Returns <code translate="no">true</code> if the cache contains an object associated with key <i translate="no">key</i>; otherwise returns <code translate="no">false</code>.</p>
<p><b>See also </b><a href="qcache.html#take" translate="no">take</a>() and <a href="qcache.html#remove" translate="no">remove</a>().</p>
<!-- @@@contains -->
<!-- $$$count[overload1]$$$count -->
<h3 class="fn" translate="no" id="count"><code class="details extra" translate="no">[noexcept]</code> <span class="type">qsizetype</span> QCache::<span class="name">count</span>() const</h3>
<p>Same as <a href="qcache.html#size" translate="no">size</a>().</p>
<!-- @@@count -->
<!-- $$$insert[overload1]$$$insertconstKey&T*qsizetype -->
<h3 class="fn" translate="no" id="insert"><span class="type">bool</span> QCache::<span class="name">insert</span>(const <span class="type">Key</span> &amp;<i>key</i>, <span class="type">T</span> *<i>object</i>, <span class="type">qsizetype</span> <i>cost</i> = 1)</h3>
<p>Inserts <i translate="no">object</i> into the cache with key <i translate="no">key</i> and associated cost <i translate="no">cost</i>. Any object with the same key already in the cache will be removed.</p>
<p>After this call, <i translate="no">object</i> is owned by the <a href="qcache.html" translate="no">QCache</a> and may be deleted at any time. In particular, if <i translate="no">cost</i> is greater than <a href="qcache.html#maxCost" translate="no">maxCost</a>(), the object will be deleted immediately.</p>
<p>The function returns <code translate="no">true</code> if the object was inserted into the cache; otherwise it returns <code translate="no">false</code>.</p>
<p><b>See also </b><a href="qcache.html#take" translate="no">take</a>() and <a href="qcache.html#remove" translate="no">remove</a>().</p>
<!-- @@@insert -->
<!-- $$$isEmpty[overload1]$$$isEmpty -->
<h3 class="fn" translate="no" id="isEmpty"><code class="details extra" translate="no">[noexcept]</code> <span class="type">bool</span> QCache::<span class="name">isEmpty</span>() const</h3>
<p>Returns <code translate="no">true</code> if the cache contains no objects; otherwise returns <code translate="no">false</code>.</p>
<p><b>See also </b><a href="qcache.html#size" translate="no">size</a>().</p>
<!-- @@@isEmpty -->
<!-- $$$keys[overload1]$$$keys -->
<h3 class="fn" translate="no" id="keys"><span class="type"><a href="qlist.html" translate="no">QList</a></span>&lt;<span class="type">Key</span>&gt; QCache::<span class="name">keys</span>() const</h3>
<p>Returns a list of the keys in the cache.</p>
<!-- @@@keys -->
<!-- $$$maxCost[overload1]$$$maxCost -->
<h3 class="fn" translate="no" id="maxCost"><code class="details extra" translate="no">[noexcept]</code> <span class="type">qsizetype</span> QCache::<span class="name">maxCost</span>() const</h3>
<p>Returns the maximum allowed total cost of the cache.</p>
<p><b>See also </b><a href="qcache.html#setMaxCost" translate="no">setMaxCost</a>() and <a href="qcache.html#totalCost" translate="no">totalCost</a>().</p>
<!-- @@@maxCost -->
<!-- $$$object[overload1]$$$objectconstKey& -->
<h3 class="fn" translate="no" id="object"><code class="details extra" translate="no">[noexcept]</code> <span class="type">T</span> *QCache::<span class="name">object</span>(const <span class="type">Key</span> &amp;<i>key</i>) const</h3>
<p>Returns the object associated with key <i translate="no">key</i>, or <code translate="no">nullptr</code> if the key does not exist in the cache.</p>
<div class="admonition warning">
<p><b>Warning: </b>The returned object is owned by <a href="qcache.html" translate="no">QCache</a> and may be deleted at any time.</p>
</div>
<p><b>See also </b><a href="qcache.html#take" translate="no">take</a>() and <a href="qcache.html#remove" translate="no">remove</a>().</p>
<!-- @@@object -->
<!-- $$$remove[overload1]$$$removeconstKey& -->
<h3 class="fn" translate="no" id="remove"><code class="details extra" translate="no">[noexcept(...)]</code> <span class="type">bool</span> QCache::<span class="name">remove</span>(const <span class="type">Key</span> &amp;<i>key</i>)</h3>
<p>Deletes the object associated with key <i translate="no">key</i>. Returns <code translate="no">true</code> if the object was found in the cache; otherwise returns <code translate="no">false</code>.</p>
<div class="admonition note">
<p><b>Note: </b>This function does not throw any exception when &quot;std::is_nothrow_destructible_v&lt;Node&gt;&quot; is true.</p>
</div>
<p><b>See also </b><a href="qcache.html#take" translate="no">take</a>() and <a href="qcache.html#clear" translate="no">clear</a>().</p>
<!-- @@@remove -->
<!-- $$$setMaxCost[overload1]$$$setMaxCostqsizetype -->
<h3 class="fn" translate="no" id="setMaxCost"><code class="details extra" translate="no">[noexcept(...)]</code> <span class="type">void</span> QCache::<span class="name">setMaxCost</span>(<span class="type">qsizetype</span> <i>cost</i>)</h3>
<p>Sets the maximum allowed total cost of the cache to <i translate="no">cost</i>. If the current total cost is greater than <i translate="no">cost</i>, some objects are deleted immediately.</p>
<div class="admonition note">
<p><b>Note: </b>This function does not throw any exception when &quot;std::is_nothrow_destructible_v&lt;Node&gt;&quot; is true.</p>
</div>
<p><b>See also </b><a href="qcache.html#maxCost" translate="no">maxCost</a>() and <a href="qcache.html#totalCost" translate="no">totalCost</a>().</p>
<!-- @@@setMaxCost -->
<!-- $$$size[overload1]$$$size -->
<h3 class="fn" translate="no" id="size"><code class="details extra" translate="no">[noexcept]</code> <span class="type">qsizetype</span> QCache::<span class="name">size</span>() const</h3>
<p>Returns the number of objects in the cache.</p>
<p><b>See also </b><a href="qcache.html#isEmpty" translate="no">isEmpty</a>().</p>
<!-- @@@size -->
<!-- $$$take[overload1]$$$takeconstKey& -->
<h3 class="fn" translate="no" id="take"><code class="details extra" translate="no">[noexcept(...)]</code> <span class="type">T</span> *QCache::<span class="name">take</span>(const <span class="type">Key</span> &amp;<i>key</i>)</h3>
<p>Takes the object associated with key <i translate="no">key</i> out of the cache without deleting it. Returns a pointer to the object taken out, or 0 if the key does not exist in the cache.</p>
<p>The ownership of the returned object is passed to the caller.</p>
<div class="admonition note">
<p><b>Note: </b>This function does not throw any exception when &quot;std::is_nothrow_destructible_v&lt;Key&gt;&quot; is true.</p>
</div>
<p><b>See also </b><a href="qcache.html#remove" translate="no">remove</a>().</p>
<!-- @@@take -->
<!-- $$$totalCost[overload1]$$$totalCost -->
<h3 class="fn" translate="no" id="totalCost"><code class="details extra" translate="no">[noexcept]</code> <span class="type">qsizetype</span> QCache::<span class="name">totalCost</span>() const</h3>
<p>Returns the total cost of the objects in the cache.</p>
<p>This value is normally below <a href="qcache.html#maxCost" translate="no">maxCost</a>(), but <a href="qcache.html" translate="no">QCache</a> makes an exception for Qt's <a href="implicit-sharing.html" translate="no">implicitly shared</a> classes. If a cached object shares its internal data with another instance, <a href="qcache.html" translate="no">QCache</a> may keep the object lying around, possibly contributing to making totalCost() larger than <a href="qcache.html#maxCost" translate="no">maxCost</a>().</p>
<p><b>See also </b><a href="qcache.html#setMaxCost" translate="no">setMaxCost</a>().</p>
<!-- @@@totalCost -->
<!-- $$$operator[][overload1]$$$operator[]constKey& -->
<h3 class="fn" translate="no" id="operator-5b-5d"><code class="details extra" translate="no">[noexcept]</code> <span class="type">T</span> *QCache::<span class="name">operator[]</span>(const <span class="type">Key</span> &amp;<i>key</i>) const</h3>
<p>Returns the object associated with key <i translate="no">key</i>, or <code translate="no">nullptr</code> if the key does not exist in the cache.</p>
<p>This is the same as <a href="qcache.html#object" translate="no">object</a>().</p>
<div class="admonition warning">
<p><b>Warning: </b>The returned object is owned by <a href="qcache.html" translate="no">QCache</a> and may be deleted at any time.</p>
</div>
<!-- @@@operator[] -->
</div>
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
